<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>John-Marco | Portfolio</title>
        <link rel="stylesheet" href="style.css">
        <link rel="icon" href="favicon.ico" type="image/x-icon" />
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    </head>
    <body>
        <header>
            <div class="brand">
                <span class="brand-name">John-Marco</span>
                <span class="brand-dot"></span>
            </div>
            <nav>
                <a id="p5Projects" href="p5Projects" class="active">p5.js Projects</a>
                <a id="VeterinaryAdventures" href="VeterinaryAdventures">Vet Game</a>
                <a id="Philosophy-website" href="Philosophy-website">Philosophy</a>
                <a id="drawing_app" href="drawing_app">Drawing App</a>
                <a id="snooker" href="snooker">Snooker</a>
            </nav>
        </header>
        <main>
            <div class="showcase-bar">
                <span id="current-project">p5Projects</span>
                <a id="visit-btn" href="p5Projects" target="_blank" rel="noopener" class="visit-btn">
                    Visit Website
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/>
                        <polyline points="15 3 21 3 21 9"/>
                        <line x1="10" y1="14" x2="21" y2="3"/>
                    </svg>
                </a>
            </div>
            <div id="show-case">
                <iframe src="p5Projects" title="My projects" id="frame"></iframe>
            </div>
        </main>
    </body>
    <script>
        const aTags = document.querySelectorAll("nav a");
        const list = [];
        aTags.forEach(tag => list.push(tag.id));

        const frame = document.getElementById("frame");
        const visitBtn = document.getElementById("visit-btn");
        const currentProject = document.getElementById("current-project");

        frame.style.opacity = 1;
        let hovered = undefined;
        let index = 0;
        let fading_in_timer, fading_out_timer;
        const fade_time = 800;
        let swapping = false;

        function setActive(id) {
            aTags.forEach(a => a.classList.remove("active"));
            document.getElementById(id).classList.add("active");
            visitBtn.href = id;
            currentProject.textContent = id;
        }

        for (let item of list) {
            document.getElementById(item).addEventListener("click", (e) => {
                e.preventDefault();
                hovered = item;
                if (frame.src.split("/").pop() != item && !swapping) {
                    swapping = true;
                    setActive(item);
                    swap(item);
                }
            });
        }

        function swap(item) {
            clearInterval(fading_out_timer);
            clearInterval(fading_in_timer);
            fade_out(frame);
        }

        function fade_in(el) {
            const spd = 10 / fade_time;
            fading_in_timer = setInterval(() => {
                if (el.style.opacity >= 1) {
                    swapping = false;
                    clearInterval(fading_in_timer);
                }
                el.style.opacity = String(Number(el.style.opacity) + spd);
            }, 10);
        }

        function fade_out(el) {
            const spd = 10 / fade_time;
            fading_out_timer = setInterval(() => {
                if (el.style.opacity <= 0) {
                    index++;
                    if (hovered) {
                        index = list.indexOf(hovered);
                        hovered = undefined;
                    } else if (index >= list.length) {
                        index = 0;
                    }
                    el.src = list[index];
                    clearInterval(fading_out_timer);
                    setTimeout(() => {
                        fade_in(el);
                    }, 300);
                }
                el.style.opacity = String(Number(el.style.opacity) - spd);
            }, 10);
        }
    </script>
</html>
